<html class="no-js" lang="zxx">
<head>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">    
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="manifest" href="site.webmanifest">
  <link rel="shortcut icon" type="../static/img/logo" href="../static/img/logo/logo_short.png">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
  <title>Flood Safe Home</title>
      <!-- CSS here -->
      
    <link rel="stylesheet" href="static/css/bootstrap.min.css">
    <link rel="stylesheet" href="static/css/owl.carousel.min.css">
    <link rel="stylesheet" href="static/css/slicknav.css">
    <link rel="stylesheet" href="static/css/flaticon.css">
    <link rel="stylesheet" href="static/css/progressbar_barfiller.css">
    <link rel="stylesheet" href="static/css/gijgo.css">
    <link rel="stylesheet" href="static/css/animate.min.css">
    <link rel="stylesheet" href="static/css/animated-headline.css">
    <link rel="stylesheet" href="static/css/magnific-popup.css">
    <link rel="stylesheet" href="static/css/fontawesome-all.min.css">
    <link rel="stylesheet" href="static/css/themify-icons.css">
    <link rel="stylesheet" href="static/css/slick.css">
    <link rel="stylesheet" href="static/css/nice-select.css">
    <link rel="stylesheet" href="static/css/style.css">
    <script src="static/js/modernizr.js"></script> 
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/4.18/esri/themes/light/main.css">
    <!--<script src="https://kit.fontawesome.com/a076d05399.js"></script>-->
    <!--<script src="https://js.arcgis.com/4.18/"></script>-->
    <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--Add field-->
    <script type="text/javascript">
    $(document).ready(function(){
      //Input fields increment limitation
        var maxField = 10; 
        var addButton = $('.add_button'); 
        var wrapper = $('.field_wrapper'); 
        var fieldHTML = '<div> <input type="text" name="field_name[]" value="" placeholder="Type your address" required/> <a href="javascript:void(0);" class="remove_button"> &nbsp; <img src="../static/img/logo/minus_icon.png"/></a></div>'; //New input field html 
        var x = 1; //Initial field counter is 1
        
        //Once add button is clicked and maxField is smaller than x, increment field counter
        $(addButton).click(function(){
            if(x < maxField){ 
                x++; 
                $(wrapper).append(fieldHTML); 
            }
        });
        
        //Once remove button is clicked, remove the field html
        $(wrapper).on('click', '.remove_button', function(e){
            e.preventDefault();
            $(this).parent('div').remove();
            x--; 
        });
    });
    </script>

<!-- Retain form-->
<script type="text/javascript">
function formProcess(){
  var capture = document.forms["input"]["chkYes"].value + '<br>';
  capture += document.forms["input"]["chkNo"].value + '<br>'; 
  document.getElementById("container left").innerHTML = capture;
}

</script>
<!-- Retain form ends-->

{% load humanize %}
<!--ArcGIS API-->
{% comment %}   <script>
    require([

      "esri/config",
      "esri/Map",
      "esri/views/MapView",
      "esri/widgets/Sketch",
      "esri/layers/GraphicsLayer",
      "esri/layers/FeatureLayer",
      "esri/widgets/BasemapToggle",
      "esri/widgets/BasemapGallery",
      "esri/widgets/LayerList",
      "esri/widgets/Legend",
      "esri/widgets/Expand",
      "esri/widgets/Search"

    ], function(esriConfig,Map, MapView, Sketch, GraphicsLayer, FeatureLayer,BasemapToggle, BasemapGallery, LayerList, Legend, Expand, Search) {

      esriConfig.apiKey = "AAPKd5dd565a8e68435fa989ce6a460dee71GW1954NPzAcw3QEQG_Cawyxn2iw7zS83Hnr53ia1CJ6-B8iTjxlIBdY41LiuJ_M6";

      const map = new Map({
        basemap: "arcgis-topographic" //Basemap layer service
      });

      const view = new MapView({
        container: "viewDiv",
        map: map,
        center: [-90.2,30.00], //Longitude, latitude
        zoom: 13
      });

      //Search widget
     // var searchWidget = new Search({
     //   view: view
     // });

     // console.log(document.getElementById("submitButton"))
     // document.getElementById("submitButton").onclick = (e)=> {
     //   e.preventDefault()
     //   let el = document.getElementById("tags")
     //   console.log(el.value)
     //   searchWidget.search(el.value).then((result)=> {
     //     console.log("result", result)
     //   })
     // }

      // Add sketch widget
      const graphicsLayerSketch = new GraphicsLayer();
      map.add(graphicsLayerSketch);

      const sketch = new Sketch({
        layer: graphicsLayerSketch,
        view: view,
        creationMode: "update" // Auto-select
      });

      view.ui.add(sketch, "top-right");

      // Add sketch events to listen for and execute query
      sketch.on("update", (event) => {

        // Create
        if (event.state === "start") {
          queryFeaturelayer(event.graphics[0].geometry);
        }
        if (event.state === "complete"){
          graphicsLayerSketch.remove(event.graphics[0]); // Clear the graphic when a user clicks off of it or sketches new one
        }
        // Change
        if (event.toolEventInfo && (event.toolEventInfo.type === "scale-stop" || event.toolEventInfo.type === "reshape-stop" || event.toolEventInfo.type === "move-stop")) {
          queryFeaturelayer(event.graphics[0].geometry);
        }

      });

      // Reference query layer
      const parcelLayer = new FeatureLayer({
         url: "https://services2.arcgis.com/njxlOVQKvDzk10uN/arcgis/rest/services/BUILDING_shp/FeatureServer/0",     //Building
        //parecel url: "https://services2.arcgis.com/njxlOVQKvDzk10uN/ArcGIS/rest/services/PARCEL/FeatureServer/0",
      });

      function queryFeaturelayer(geometry) {

        const parcelQuery = {
         spatialRelationship: "intersects", // Relationship operation to apply
         geometry: geometry,  // The sketch feature geometry
         outFields: ["ADDRESS","STREET", "SFT"], // Attributes to return
         //parcel outFields: ["SITE_ID","SUBDIVISIO"], // Attributes to return
         returnGeometry: true
        };

        parcelLayer.queryFeatures(parcelQuery)
        .then((results) => {


          displayResults(results);

        }).catch((error) => {
          console.log(error);
        });

      }

      // Show features (graphics)
      function displayResults(results) {

      // Create a blue polygon
        const symbol = {
          type: "simple-fill",
          color: [ 20, 130, 200, 0.5 ],
          outline: {
            color: "white",
            width: .5
          },
        };


        //Building
        const popupTemplate = {
          title: "<b> {ADDRESS} {STREET} </b>",
          content: "Sqaure fottage:  {SFT}"
        };

                
        //Parcel
       // const popupTemplate = {
       //   title: "<b>{SITE_ID} </b>",
       //   content: "Subdivision:  {SUBDIVISIO}"
       // }; 

        // Set symbol and popup
        results.features.map((feature) => {
          feature.symbol = symbol;
          feature.popupTemplate = popupTemplate;
          return feature;
        });

        // Clear display
        view.popup.close();
        view.graphics.removeAll();

       // Add features to graphics layer
        view.graphics.addMany(results.features);

      }
      
      
      //basemap toggle
      const basemapToggle = new BasemapToggle({
        view: view,
        nextBasemap: "arcgis-imagery"
     });

      view.ui.add(basemapToggle,"bottom-right");
    });
  </script> {% endcomment %}
</head>

<body>
   
     <header class="header header-map">


        <!-- Header Start -->
        <div class="header-area header-transparent mapHeader">
            <div class="main-header ">
                <div class="header-bottom  header-sticky">
                    <div class="container-fluid">
                        <div class="row align-items-center">
                            <!-- Logo -->
                            <div class="col-xl-2 col-lg-2">
                                <div class="logo">
                                    <a href="/"><img src="static/img/logo/logo.png" alt=""></a>
                                </div>
                            </div>
                            <div class="col-xl-10 col-lg-10">
                                <div class="menu-wrapper  d-flex align-items-center justify-content-end">
                                    <!-- Main-menu -->
                                    <div class="main-menu d-none d-lg-block">
                                        
                                            <ul id="navigation">
                                                <li><a href="/">Home</a></li>
                                                <li><a href="/about">About</a>
                                                  <ul class="submenu">
                                                       <li><a href="/about#about">About</a></li>
                                                        <li><a href="/about#goals">Goals</a></li>
                                                        <li><a href="/about#team">Our Team</a></li>
                                                    </ul>
                                                </li>
                                                <li><a href="/freeboardproject">Freeboard Project</a>
                                                    <ul class="submenu">
                                                       <li><a href="/freeboardproject#introduction">Introduction</a></li>
                                                        <li><a href="/freeboardproject#objects">Objects</a></li>
                                                        <li><a href="/freeboardproject">Methodologies</a></a></li>
                                                    </ul>
                                                </li>
                                                <li><a href="/map"><b>Decision Making Map</b></a>
                                                    {% comment %} <ul class="submenu">
                                                        <li><a href="/map">Go To Map</a></li>
                                                       <li><a href="/">User Guide</a></li>
                                                    </ul> {% endcomment %}
                                                </li>
                                                <li><a href="/survey">Survey</a></li>
                                                <li><a href="/helpcenter">Help Center</a></li>
                                            </ul>
                                        
                                    </div>
                                </div>
                            </div>
                            <!-- Mobile Menu -->
                            <div class="col-12">
                                <div class="mobile_menu d-block d-lg-none"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Header End -->
    </header>

 
  

  <!-- autosuggestion-->
    <script> 
    jQuery.noConflict();
    jQuery(function ($) {    
    
    //Autosugestion for homeowner
    $( "#tags").autocomplete({
      source: "{% url 'autosuggest' %}"
        });

    //Autosugestion for community analysis
          // $( "#user_input").autocomplete({
     // source: "{% url 'autosuggest' %}"
    //    });
     //} );

     $( "#user-input-co").autocomplete({
      source: "{% url 'autosuggest' %}"
        });
     } );
     </script>

     </script>
   <!--autosuggestion End-->
 <!-- Banner-->
    <div class="banner">
        <div class="banner__content">
            <div class="banner__text">
                <strong> WEB TOOL UNDER DEVELOPMENT</strong> 
            </div>
            <button class="banner__close" type="button">
                <span class="material-icons">
                close
                </span>
            </button>
        </div>
    </div>
    <!--Banner ends-->

 
  
 <!-- Select your building information-->
 <div class="container left" > 
  <form method="get" action="/search" name="userInput" id="my-form">
            {% csrf_token %} 
      <p> 
        <h2 class ="map-style-sidebar-title"><b class="map-style-sidebar-b"> Building Information</b> <!-- <button class="btn btn-result2" type="submit" > Get results</button>--></h2> 
          <div class="box">
         
              <!--User type-->
              <label> <b class="map-style"> User Type  </b></label><br>
                <label for="chkYes"><input type="radio" name ="chk" id="chkYes" value = "Homeowner" class="bar" onclick="ShowHideDiv()"/> Homeowner</label>
                <label for="chkTenant"><input type="radio" name ="chk" id="chkTenant" value = "Tenant" class="bar2" onclick="ShowHideDiv3()"/ disabled> Tenant</label> <br>         
                <label for="chkLandlord"><input type="radio" name ="chk" id="chkLandlord" value = "Landlord" class="bar" onclick="ShowHideDiv4()"/ disabled> Landlord</label>
                <label for="chkNo"><input type="radio" name ="chk" id="chkNo" value = "Community official" class="bar3" onclick="ShowHideDiv()"/> Community official</label>
                
              <!--Building type-->
              <div id="dvPassport" style="display: none">
                <label><b class="map-style">Building Type </b></label><br>
                  <label><input type="radio" name ="selectBox" value = "New building" class="bar"  checked> New building</label>
                  <label><input type="radio" name ="selectBox" value = "Existing building" class="bar4"  disabled> Existing building</label>    
                <br>  
                
                <!--Address or Parcel ID-->
                    <select name="select1" id="select1" style="margin: 5px 20px 5px 0px; padding: 5px 33px 5px 0px;">
                        <option value="Address">Address</option>
                        <option value="Subdivison" disabled>Subdivison</option>
                        <option value="Parcel" disabled>Parcel</option>
                        <option value="Zip code" disabled>Zip code</option>
                    </select>

                        <select name="select12" id="select2" style="margin: 5px 0px 5px 0px; padding: 5px 102px 5px 0px;">
                            <option value="">Select your parish</option>
                            <option value="Jefferson"> Jefferson</option>
                            <option value="St. Tammany"> St. Tammany</option>
                            <option value="Terrebonne"> Terrebonne </option>
                        </select><br> 
                              
                        <input type="text"  name="location"  id="tags" style="margin: 5px 0px 5px 0px; padding: 5px 102px 5px 0px;" placeholder="Type your address or parceID"  class="text"  value={{location|safe}} > <br>
                        {% comment %} <!--Square footage-->
                <label><b class="map-style">Square footage </b> </label><br>
                  <input type="text"  name="sqft1"  id="sqft1" placeholder="Type your building's square footage"  class="text" > <br>
               
               <!--Number of Stories -->        
                <label> <b class="map-style">Number of Stories  </b> </label><br>
                  <label><input type="radio" name ="stories" id="stories" value = "1" class="bar"  > One story</label>
                  <label><input type="radio" name ="stories" id="stories" value = "2" class="bar5"  > Two or more stories</label> {% endcomment %}
              </div> <!--Building type div end-->

              <!--This option will be appear when user select community official-->
              <div id="as" style="display: none">
                    <label> <b class="map-style"> Assessment Scale  </b></label><br>
                      <label for="chkYes2"><input type="radio" name ="chkYes2" id="chkYes2" value = "Single_building" class="bar" data-require-pair="#chkNo" onclick="ShowHideDiv2()" disabled>
                      Single building</label>
                      <label for="chkNo2"><input type="radio" name ="chkYes2" id="chkNo2" value = "Spatial_scale" class="margin1" onclick="ShowHideDiv2()">
                        Spatial scale</label>
                

                      <!--This option will be appear when user select single-building-->
                      <div id="singleBuilding" style="display: none">
                <!--Address or Parcel ID-->
                    <select name="select1" id="select1" style="margin: 5px 20px 5px 0px; padding: 5px 33px 5px 0px;">
                      <option value="">Select by</option>
                      <option value="Address">Address</option>
                      <option value="Subdivison" disabled>Subdivison</option>
                      <option value="Parcel" disabled>Parcel</option>
                      <option value="Zip code" disabled>Zip code</option>
                  </select>

                      <select name="select12" id="select3" style="margin: 5px 0px 5px 0px; padding: 5px 102px 5px 0px;">
                          <option value="">Select your parish</option>
                          <option value="Jefferson"> Jefferson</option>
                          <option value="St. Tammany"> St. Tammany</option>
                          <option value="Terrebonne"> Terrebonne </option>
                      </select><br>
                      
                        {% comment %} <!--Average Building Size (Livable Square Footage) -->
                        <label><b class="map-style"> Average Building Size (Livable Square Footage) </b> </label><br>
                          {% comment %} <input type="text"  name="sqftCSBLD"  id="sqftCSBLD" placeholder="Type average building's square footage"  class="text"> <br> {% endcomment %}
                          {% comment %} <input type="text"  name="sqft"  id="sqft" placeholder="Type average building's square footage"  class="text"> <br> {% endcomment %}

                        <!--Number of Stories -->        
                        {% comment %} <label> <b class="map-style">Number of Stories  </b> </label><br> {% endcomment %}
                          {% comment %} <label><input type="radio" name ="stories1-co1" id="stories1-co1" value = "1" class="bar"> One story</label>
                          <label><input type="radio" name ="stories1-co1" id="stories1-co1" value = "2" class="bar5"> Two or more stories</label> {% endcomment %}
                          {% comment %} <label><input type="radio" name ="stories" id="stories" value = "1" class="bar"> One story</label>
                          <label><input type="radio" name ="stories" id="stories" value = "2" class="bar5"> Two or more stories</label> {% endcomment %} 

                      </div> <!--singlebuilding div end -->    

                      <!-- This option will be appear when spatial scale is selected-->
                      <div id="SpatialScale" style="display: none">
                        <label> <b class="map-style"> Select area from the map   </b></label><br>
                        <i style="margin:0 0 0 30px">Please select area using a tool from the map.</i><br>
                    
                        <!--Address or Parcel ID-->
                  <select name="select1" id="select1" style="margin: 5px 20px 5px 0px; padding: 5px 33px 5px 0px;">
                      <option value="">Select by</option>
                      <option value="Address">Address</option>
                      <option value="Subdivison" disabled>Subdivison</option>
                      <option value="Parcel" disabled>Parcel</option>
                      <option value="Zip code" disabled>Zip code</option>
                  </select>

                      <select name="select12" id="select4" style="margin: 5px 0px 5px 0px; padding: 5px 102px 5px 0px;">
                                {% comment %} <option value="">Select your parish</option> {% endcomment %}
                                <option value="Jefferson"> Jefferson</option>
                                <option value="St. Tammany"> St. Tammany</option>
                                <option value="Terrebonne"> Terrebonne </option>
                      </select><br> 

                        <!--Add fields-->
                        <label> <b class="map-style"> Type your address(es)   </b></label><br>
                        <!--<input type="text" name="location" id="location" placeholder="Please type your address(es). You can type multiple addresses" class="text" multiple style="height:100px"/>-->
                        <!--<textarea rows="4" cols="39" name="comment" form="userInput" placeholder="Please type your address(es). You can type multiple addresses"></textarea>-->
                          
                          <!-- new code with remove button-->  
                            <input type="text" id="user-input-co"  onfocus="this.value=''" value={{location|safe}}>
                            <input type="button" onclick="addItem()" class="buttonClass" value="Add new">
                            <input type="button" onclick="removeItem()" class="buttonClass" value="Remove">
                              <div style="border-style:outset; width:100%; margin: 10px 0px 10px 0px;" > 
                                <input type="hidden" name="addr_list" id="addr_list" value="" />
                                <ul id="list"></ul>
                              </div> 
                              <div style="border-style:outset; width:100%; margin: 10px 0px 10px 0px;" > 
                               <!--<h3 style="color:blue;"><strong>Selected buildings:</strong> </h3>-->
                                {% for individual in buildinglocation %}
                                    {{individual|safe}} <br>
                                    {% endfor %}  
                              </div>                                
                          
                              <!-- new code with remove button ends--> 
                    
                          <!-- code with just add new button-->
                          {% comment %} <input type="0text" id="user_input" onfocus="this.value=''" value={{location|safe}} />
                          <input type="button" id="add" value="Add New">
                          <input type="hidden" name="addr_list" id="addr_list" value="" />
                            <ul id="list_item" class="a"></ul> {% endcomment %}
                          <!-- code with just add new button ends-->

                        <!--Average Building Size (Livable Square Footage) -->
                        {% comment %} <label><b class="map-style"> Average Building Size (Livable Square Footage) </b> </label><br>
                        <input type="text"  name="sqftCSSCL"  id="sqftCSSCL" placeholder="Type average building's square footage"  class="text"> <br> {% endcomment %}
                        {% comment %} <input type="text"  name="sqft"  id="sqft" placeholder="Type average building's square footage"  class="text"> <br> {% endcomment %}


                            <!-- Number of Stories -->        
                            {% comment %} <label> <b class="map-style">Number of Stories  </b> </label><br> {% endcomment %}
                              {% comment %} <label><input type="radio" name ="stories1-co2" id="stories1-co2" value = "1" class="bar"> One story</label>
                              <label><input type="radio" name ="stories2-co2" id="stories2-co2" value = "2" class="bar5"> Two or more stories</label> {% endcomment %}
                              {% comment %} <label><input type="radio" name ="stories" id="stories" value = "1" class="bar"> One story</label>
                              <label><input type="radio" name ="stories" id="stories" value = "2" class="bar5"> Two or more stories</label> {% endcomment %}

                      </div>  <!-- spatial scale div end -->


              </div> <!-- community official options div end -->
          

               <!--Square footage-->
                <label><b class="map-style"> Average Building Size (Livable Square Footage)  </b> </label><br>
                <input type="text"  name="sqft1"  id="sqft1" style="margin: 5px 0px 5px 0px; padding: 5px 102px 5px 0px;" placeholder="Type your building's square footage"  class="text" required> <br>
               
               <!--Number of Stories -->        
                <label> <b class="map-style">Number of Stories  </b> </label><br>
                  <label><input type="radio" name ="stories" id="stories" value = "One story" class="bar" required> One-story</label>
                  <label><input type="radio" name ="stories" id="stories" value = "Two or more stories" class="bar5"  required> Two or more stories</label>  <br>
                <!-- <h3 style="color:blue;"><strong>Selected number of stories:</strong> {{No_Floors|safe}} </h3>-->
                        
              <!--Advanced parameter-->
                    
     <input type="button" onclick='displayAdv()' class="btn-adv"  style="display: flex; justify-content:flex-end" value="Advanced parameters">
     {% comment %} <a class="buttonClass btn-adv tip" title="Under development"> Advanced parameters </a> {% endcomment %}


    {% comment %} <tr>
        <td>
         <input type="button" onclick='show(1);' class="buttonClass" value="Advanced parameters"> 
          <br />
        </td>
        <td>
            &nbsp;
        </td>
       {% endcomment %}
        
       <div id="adv_Box_Div" style="display:none;">
         
                          <!-- Freeboard height above the BFE -->   
{% comment %}         <label><b class="map-style"> Freeboard height above the BFE (in feet) </b> </label><br>
                      <input type="text"  name="freeboard-bfe-co1"  id="freeboard-bfe-co1" placeholder="Type targeted freeboard height above the Based Flood Elevation"  class="text"> <br> {% endcomment %}
                    
                    
                     <!-- Current CRS rating -->  
                     <label><b class="map-style" style="margin: 5px 20px 5px 0px; padding: 2px 33px 5px 0px;"> Select the <i>current</i> CRS rating of </b> </label><br>              
                     <div class="select-form" >
                            <div class="select-itms">
                              <select name="select" id="crsSelection" style="margin: 5px 20px 5px 0px; padding: 5px 33px 5px 0px;">
                                <OPTION VALUE=""> 1, with a 45% discount </option>
                                <OPTION VALUE=""> 2, with a 40% discount </option>
                                <OPTION VALUE=""> 3, with a 35% discount </option>
                                <OPTION VALUE=""> 4, with a 30% discount </option>
                                <OPTION VALUE=""> 5, with a 25% discount </option>
                                <OPTION VALUE=""> 6, with a 20% discount </option>
                                <OPTION VALUE=""> 7, with a 15% discount </option>
                                <OPTION VALUE=""> 8, with a 10% discount </option>
                                <OPTION VALUE=""> 9, with a 5% discount </option>
                                <OPTION VALUE=""> 10, with a 0% discount </option>
                                </select>
                            </div>
                        </div>    
                      
                      <!-- Targeted CRS rating --> 
                      <label><b class="map-style" style="margin: 5px 20px 5px 0px; padding: 2px 33px 5px 0px;"> Select the <i>targeted</i> CRS rating of </b> </label><br>              
                        <div class="select-form" >
                            <div class="select-itms">
                                <select name="select" id="crsTarget" style="margin: 5px 20px 5px 0px; padding: 5px 33px 5px 0px;">
                                    <OPTION VALUE=""> 1, with a 45% discount </option>
                                    <OPTION VALUE=""> 2, with a 40% discount </option>
                                    <OPTION VALUE=""> 3, with a 35% discount </option>
                                    <OPTION VALUE=""> 4, with a 30% discount </option>
                                    <OPTION VALUE=""> 5, with a 25% discount </option>
                                    <OPTION VALUE=""> 6, with a 20% discount </option>
                                    <OPTION VALUE=""> 7, with a 15% discount </option>
                                    <OPTION VALUE=""> 8, with a 10% discount </option>
                                    <OPTION VALUE=""> 9, with a 5% discount </option>
                                    <OPTION VALUE=""> 10, with a 0% discount </option>
                                </select>
                            </div>
                        </div>
                  
				  
				  
				   <!-- Assessment Timeline -->
                    <label><b class="map-style" style="margin: 5px 20px 5px 0px; padding: 2px 33px 5px 0px;"> Assessment Timeline </b> </label>     <br>       
                              <select name="select" id="AssTime" style="margin: 5px 20px 5px 0px; padding: 5px 33px 5px 0px;">
                                  <OPTION VALUE=""> 5 years </option>
                                  <OPTION VALUE=""> 10 years </option>
                                  <OPTION VALUE=""> 15 years </option>
                                  <OPTION VALUE=""> 20 years </option>
                                  <OPTION VALUE=""> 30 years </option>
                                  <OPTION VALUE=""> 40 years </option>
                                  <OPTION VALUE=""> 70 years </option>
                                <OPTION VALUE=""> 100 years</option>
                              </select>
     

                    <!-- Select the appropriate real discount rate for the assessment -->
                    <label><b class="map-style"style="margin: 5px 20px 5px 0px; padding: 2px 33px 5px 0px;"> Select the appropriate real discount rate for the assessment  </b> </label><br>              
                      <div class="select-form" >
                          <div class="select-itms">
                              <select name="select" id="realDiscount" style="margin: 5px 20px 5px 0px; padding: 2px 33px 5px 0px;">
                                  <OPTION VALUE=""> Select 0% of real discount rate </option>
                                  <OPTION VALUE=""> Select 3% of real discount rate</option>
                                  <OPTION VALUE=""> Select 7% of real discount rate </option>
                                  <OPTION VALUE=""> Select 10% of real discount rate </option>
                              </select>
                          </div>
                      </div>     

                    <!-- Select the appropriate real discount rate for the assessment -->
{% comment %}                     <label><b class="map-style" style="margin: 5px 0px 5px 0px; padding: 2px 33px 5px 0px;"> CRS Rate  </b> </label>             

                              <select name="crsRate" id="crsRate" onchange="myFunction()" style="margin: 5px 0px 5px 0px; padding: 5px 33px 5px 0px;">
                                <option value="null"> - </option>
                                <option value="45">1</option>
                                <option value="40">2</option>
                                <option value="35">3</option>
                                <option value="30">4 </option>
                                <option value="25">5</option>
                                <option value="20">6</option>
                                <option value="15">7</option>
                                <option value="10">8</option>
                                <option value="5">9</option>
                                <option value="0">10</option>
                              </select>            
                          <span id="crsRate_value" ></span> {% endcomment %} 
       
                    <label><b class="map-style" style="margin: 5px 0px 5px 0px; padding: 2px 5px 5px 0px;">Expected occupancy timeline:  </b> </label> <br>
                        
                        0 Years <input id="rangeInput1" style ="width: 80px" type="range" min="0" max="100" value="30" oninput="years.value=rangeInput1.value" />
                        100 Years

                        <input id="years" type="number" style="margin: 5px 0px 5px 15px; padding: 2px 5px 5px 0px;" value="30" min="0" max="100" oninput="rangeInput1.value=years.value" />  Years 
   
         </div>
            <!--Advanced parameter ends-->
          </div> <!--dib box end-->     

      
        <br>
        <p align="right">
          <input type="text" style="display:none;"/> <!--To avoid resfresh page-->
          <input class ="btn-result" type="submit" id="buttontest" value="Get results" onkeydown="javascript: if (event.keyCode == 13) {mf_KeyDown();}"/> 
        </p>
       {% comment %} <button class="btn " type="submit" id="submitButton"> Show map</button>    {% endcomment %}
      </form>
      </p>
 <hr class="style-four">
 <!-- Select your building information end-->
 <!-- Side bar naviation menu-->
  <p>
    <h2 class ="map-style-sidebar-title"><b class="map-style-sidebar-b map">Freeboard Cost Analysis Report</b></h2>
    <div class="section-nav box">
    <nav>
    <ul >
        <li><a href="#section-1">Summary</a></li>
        <li><a href="#section-2">Monthly Savings</a></li>
        <li><a href="#section-3">Monthly Freeboard Cost</a></li>
        <li><a href="#section-4">Monthly Insurance Premium Savings</a></li>
        <li><a href="#section-5">Monthly Savings from Flood Loss Reduction</a></li>
       {% comment %}  <li><a href="#section-6">Time to Recover the Freeboard Cost</a></li>
        <li><a href="#section-7">Overall graph</a></li> {% endcomment %}
        <li><a>Save the outcome as a &nbsp;
            <select name="saveresult" id="saveresult" onchange="openInNewTab(this);"  target="_blank">
                                      <option value="{% url 'nodisc'  %}"> Format</option>
                                      <option value="{% url 'exportfile'  %}"> CSV file </option>
                                      <option value="{% url 'exportshp'  %}"> SHAPE file </option>
                                      <option value="{% url 'report'  %}"> PDF file</option>
                                      
            </select>
            </li>    
             {% comment %} <button class="btn btn-dl"><i class="fa fa-download"></i> </button> {% endcomment %}
            </a>  
        {% comment %} <li><a href="{% url 'report'  %}"><strong>Export report </strong></a></li>     {% endcomment %}
         {% comment %} 
        <li><a href="{% url 'exportpdf'  %}">Save the outcome as a PDF  
            <button class="btn btn-dl"><i class="fa fa-download"></i> </button>
             {% endcomment %}
            {% comment %}  
        <li><a href="{% url 'exportshp'  %}">Save the outcome as a SHP  
            <button class="btn btn-dl"><i class="fa fa-download"></i> </button>
            </a>                  {% endcomment %}
        <!--<li><a class="sidemenu" href="#">Save as a PDF</a>-->
     </ul>
    </nav>
    </div>
  </p>
  
</div>
<!-- Side bar naviation menu end-->

<!-- Error message-->                                
  {% if messages %}
  {% for message in messages %}
  <div class="alert {{ message.tags }} alert-dismissible fade show my-0" role="alert">
    <strong>{{ message }}</strong>
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  {% endfor %}
  {% endif %}

<!-- Error message ends--> 
<main>
<!--Leaflet map-->
<div id = "pdf_wrap">
  <div id="map" style=" height: 45%; width: 70%; float: right; margin: 0 15px 0 0; z-index: -1"><section id="section-1"></section> 
    <script>
      // initialize the map on the "map" div with a given center and zoom
      var map = L.map('map', {
        center: [29.99,-90.15],
        measureControl:true,
        zoomSnap: 0.25,
        zoomControl:true, maxZoom:45, minZoom:1,
        zoomDelta: 0.25,
        zoom: 10
      });
    
      //Add scale
      L.control.scale().addTo(map);
    
      //Tile layer
      L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox/streets-v11',
        tileSize: 512,
        zoomOffset: -1,
        accessToken: 'pk.eyJ1Ijoiaml5b3VuZyIsImEiOiJja3o1eXFqNHIwdjhzMm9tejh3eWZjd2R4In0.Rz8iZagw0-OVOS1fjKMwzQ'
      }).addTo(map);
    
    
      var marker = L.marker([{{lattitude_list}},{{longitude_list}}]).addTo(map);
    </script>
  </div>

 
<!--Result details-->
<!--Summary-->
<div class="left2 section-tittle mb-40"> 
 <hr class="style-five">
 <section id="section-2"> 
  <h2>Freeboard Cost Analysis Report</h2>
        <div class="optimal map-style">For your home,  <b class="summary-b">{{OptimalFreeboard}} ft </b> </span> of freeboard is recommended<br>
          resulting in monthly savings of <b class="summary-b">${{OptimalSaving}} </b> </u></div> <br>
      <div class="pricing row2" > 
      <div class="pricing-slider column2"> 
        <center><label class="form-slider" >
          <img id='img' src='static/img/construction/twofeet.png' class="pricing-slider-img"/><br><br>
          <center><div class="pricing-slider-value" ></div></center> <br>
          <datalist id="scale">
            <option>0</option>
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
          </datalist>
          <input onchange='setImage(this)'
            type="range"
            value="{{OptimalFreeboard}}"
            class="slider" id="myRange" list="scale"
            data-price-input='{
                "0": "0ft freeboard",
                "1": "1ft freeboard",
                "2": "2ft freeboard",
                "3": "3ft freeboard",
                "4": "4ft freeboard"                
              }'
          />
        </label></center>
      </div>
          
  <div  style=" display:inline-block; vertical-align: top; "  >
     
      <!--Monthly premium savings-->
      <!--  for calculations with below BFE   -->
      <!--  <div
        class="pricing-item-price" 
        data-price-output='{
          "-4": ["$", {{summation_total_monthly_premium_saving0}},""],
          "-3": ["$", {{summation_total_monthly_premium_saving1}},""],
          "-2": ["$", {{summation_total_monthly_premium_saving2}},""],
          "-1": ["$", {{summation_total_monthly_premium_saving3}},""],
          "0": ["$", {{summation_total_monthly_premium_saving4}},""], 
          "1": ["$", {{summation_total_monthly_premium_saving5}},""],
          "2": ["$", {{summation_total_monthly_premium_saving6}},""],
          "3": ["$", {{summation_total_monthly_premium_saving7}},""],
          "4": ["$", {{summation_total_monthly_premium_saving8}},""]
        }'
      > -->

       <!--  for calculations without below BFE   -->
      <div
        class="pricing-item-price" 
        data-price-output='{
          "0": ["$", {{summation_total_monthly_premium_saving0}},""], 
          "1": ["$", {{summation_total_monthly_premium_saving1}},""],
          "2": ["$", {{summation_total_monthly_premium_saving2}},""],
          "3": ["$", {{summation_total_monthly_premium_saving3}},""],
          "4": ["$", {{summation_total_monthly_premium_saving4}},""] 
           }'
      > 

    <p class="grid-style3 map-style"> When you add <b class="map-style b-summary-value2"> <span id="demo"> </span> ft</b> of  freeboard, </p>
      <p class="grid-style3 map-style" ><b class="summary-b">Savings from Mitigation</b> <br>
       <div class="vl"><p class="grid-style3 map-style" >
        <b class="b-summary-value map-style">        
        <span class="pricing-item-price-currency">$</span><!-- 
     --><span class="pricing-item-price-amount">0</span><!-- 
     --><span class="pricing-item-price-after"></span> </b> insurance savings per month <img id='img' src='static/img/logo/blue_question.png' class="img-q tip"  title="Monthly Savinngs is the freeboard's monthly loan payment subtracted from the monthly premium savings of the freeboard added to its monthly flood loss reduction."/></p>
    <!--Flood loss-->
    <!--  for calculations with below BFE   -->
    <!--  <div
        class="pricing-item-price"
        data-price-output='{
          "-4": ["$", {{summation_monthly_avoided_loss0}},""],
          "-3": ["$", {{summation_monthly_avoided_loss1}},""],
          "-2": ["$", {{summation_monthly_avoided_loss2}},""],
          "-1": ["$", {{summation_monthly_avoided_loss3}},""],
          "0": ["$", {{summation_monthly_avoided_loss4}},""],
          "1": ["$", {{summation_monthly_avoided_loss5}},""],
          "2": ["$", {{summation_monthly_avoided_loss6}},""],
          "3": ["$", {{summation_monthly_avoided_loss7}},""],
          "4": ["$", {{summation_monthly_avoided_loss8}},""]
          }'
      > -->
        <!--  for calculations without below BFE   -->
      <div
        class="pricing-item-price"
        data-price-output='{
          "0": ["$", {{summation_monthly_avoided_loss0}},""],
          "1": ["$", {{summation_monthly_avoided_loss1}},""],
          "2": ["$", {{summation_monthly_avoided_loss2}},""],
          "3": ["$", {{summation_monthly_avoided_loss3}},""],
          "4": ["$", {{summation_monthly_avoided_loss4}},""]
          }'
      >


      <p class="grid-style3 map-style">
      <b class="b-summary-value map-style"> 
        <span class="pricing-item-price-currency">$</span><!-- 
     --><span class="pricing-item-price-amount">0</span><!-- 
     --><span class="pricing-item-price-after"></span> </b> reduced flood losses per month <img id='img' src='static/img/logo/blue_question.png' class="img-q tip" title="Reduction In Flood Losses Per Month is the difference between the expected annual flood loss calculated for adding the freeboard and the expected annual  loss with no freeboard added divided by 12."/>
      </div>
    </div>    
  </div>
<br>

      <!--amortized cost-->
      <!--  for calculations with below BFE   -->
       <!-- <div
        class="pricing-item-price"
        data-price-output='{
         "-4": ["$", {{summation_Amortized_FC0}},""],
          "-3": ["$", {{summation_Amortized_FC1}},""],
          "-2": ["$", {{summation_Amortized_FC2}},""],
          "-1": ["$", {{summation_Amortized_FC3}},""],
          "0": ["$", {{summation_Amortized_FC4}},""],
          "1": ["$", {{summation_Amortized_FC5}},""],
          "2": ["$", {{summation_Amortized_FC6}},""],
          "3": ["$", {{summation_Amortized_FC7}},""],
          "4": ["$", {{summation_Amortized_FC8}},""]
        }'
      > -->
       <!--  for calculations without below BFE   -->
      <div
        class="pricing-item-price"
        data-price-output='{
         "0": ["$", {{summation_Amortized_FC0}},""],
          "1": ["$", {{summation_Amortized_FC1}},""],
          "2": ["$", {{summation_Amortized_FC2}},""],
          "3": ["$", {{summation_Amortized_FC3}},""],
          "4": ["$", {{summation_Amortized_FC4}},""]
        }'
      > 


      <p class="grid-style3 map-style" ><b class="summary-b">Cost of Mitigation</b> <br>
      <div class="vl"> <p class="grid-style3 map-style" >
      <b class="b-summary-value map-style">      
        <span class="pricing-item-price-currency">$</span><!-- 
     --><span class="pricing-item-price-amount">0</span><!-- 
     --><span class="pricing-item-price-after"></span> </b> amortized cost per month <img id='img' src='static/img/logo/blue_question.png' class="img-q tip" title=""/></p>
       

      <!--Freeboard cost-->
      {% load humanize %}

      <!--  for calculations with below BFE   -->

      <!--
         <div
        class="pricing-item-price"
        data-price-output='{
         "-4": ["$", {{summation_freeboardCost0}},""],
          "-3": ["$", {{summation_freeboardCost1}},""],
          "-2": ["$", {{summation_freeboardCost2}},""],
          "-1": ["$", {{summation_freeboardCost3}},""],
          "0": ["$", {{summation_freeboardCost4}},""],
          "1": ["$", {{summation_freeboardCost5}},""],
          "2": ["$", {{summation_freeboardCost6}},""],
          "3": ["$", {{summation_freeboardCost7}},""],
          "4": ["$", {{summation_freeboardCost8}},""]
        }'
      >
      -->

      <!--  for calculations without below BFE   -->

      <div
        class="pricing-item-price"
        data-price-output='{
          "0": ["$", {{summation_freeboardCost0}},""],
          "1": ["$", {{summation_freeboardCost1}},""],
          "2": ["$", {{summation_freeboardCost2}},""],
          "3": ["$", {{summation_freeboardCost3}},""],
          "4": ["$", {{summation_freeboardCost4}},""]       
        }'
      >
            <!--Part of title...Freeboard cost is calculated as a total loan amount with 30-year term and 3% interest rate. The cost of the freeboard with no loan is $7490" --> 
      <p class="grid-style3 map-style b-summary-const">
         (based on <b class="map-style b-summary-value2">
        <span class="pricing-item-price-currency">$</span><!-- 
     --><span class="pricing-item-price-amount">0</span><!-- 
     --><span class="pricing-item-price-after"></span> </b> additional construction cost)  <img id='img' src='static/img/logo/blue_question.png' class="img-q tip" title="Freeboard Cost is the product of freeboard height and cost factor of (0.023) multiplied by the construction cost of the home. Freeboard cost is calculated as a total loan amount with 30-year term and 3% interest rate. The cost of the freeboard with no loan is $7490"/></p>
      </div>   
    </div>
    <br>

        
     <!--  for calculations with below BFE   -->
     <!-- 
       <div
        class="pricing-item-price"
        data-price-output='{
          "-4": ["$", {{summation_total_savings_permonth_insurance0}},""],
          "-3": ["$", {{summation_total_savings_permonth_insurance1}},""],
          "-2": ["$", {{summation_total_savings_permonth_insurance2}},""],
          "-1": ["$", {{summation_total_savings_permonth_insurance3}},""],
          "0": ["$", {{summation_total_savings_permonth_insurance4}},""],
          "1": ["$", {{summation_total_savings_permonth_insurance5}},""],
          "2": ["$", {{summation_total_savings_permonth_insurance6}},""],
          "3": ["$", {{summation_total_savings_permonth_insurance7}},""],
          "4": ["$", {{summation_total_savings_permonth_insurance8}},""]
        }'
      >
     -->

      <!--  for calculations without below BFE   -->
      <div
        class="pricing-item-price"
        data-price-output='{
          "0": ["$", {{summation_total_savings_permonth_insurance0}},""],
          "1": ["$", {{summation_total_savings_permonth_insurance1}},""],
          "2": ["$", {{summation_total_savings_permonth_insurance2}},""],
          "3": ["$", {{summation_total_savings_permonth_insurance3}},""],
          "4": ["$", {{summation_total_savings_permonth_insurance4}},""]
        }'
      >

      <p class="grid-style3 map-style" ><b class="summary-b">Total Monthly Savings</b> <br>
      <div class="vl"> <p class="grid-style3 map-style" >
  {% comment %}     <b class="b-summary-value map-style">      
        <span class="pricing-item-price-currency">$</span><!-- 
     --><span class="pricing-item-price-amount">0</span><!-- 
     --><span class="pricing-item-price-after"></span> </b> savings per month (flood insurance only) <img id='img' src='static/img/logo/blue_question.png' class="img-q tip" title="Insurance savings per month is the difference between the annual premium calculated for adding the freeboard and the annual premium with no freeboard added divided by 12."/></p>
       {% endcomment %}

       <!--Flood loss-->

       <!--  for calculations with below BFE   -->
      <!--
         <div
        class="pricing-item-price"
        data-price-output='{
          "-4": ["$", {{summation_total_monthly_saving0}},""],
          "-3": ["$", {{summation_total_monthly_saving1}},""],
          "-2": ["$", {{summation_total_monthly_saving2}},""],
          "-1": ["$", {{summation_total_monthly_saving3}},""],
          "0": ["$", {{summation_total_monthly_saving4}},""],
          "1": ["$", {{summation_total_monthly_saving5}},""],
          "2": ["$", {{summation_total_monthly_saving6}},""],
          "3": ["$", {{summation_total_monthly_saving7}},""],
          "4": ["$", {{summation_total_monthly_saving8}},""]
        }'
      >
      -->

       <!--  for calculations without below BFE   -->
      <div
        class="pricing-item-price"
        data-price-output='{
          "0": ["$", {{summation_total_monthly_saving0}},""],
          "1": ["$", {{summation_total_monthly_saving1}},""],
          "2": ["$", {{summation_total_monthly_saving2}},""],
          "3": ["$", {{summation_total_monthly_saving3}},""],
          "4": ["$", {{summation_total_monthly_saving4}},""]
        }'
      >

      <p class="grid-style3 map-style">
      <b class="b-summary-value map-style"> 
        <span class="pricing-item-price-currency">$</span><!-- 
     --><span class="pricing-item-price-amount">0</span><!-- 
     --><span class="pricing-item-price-after"></span> </b> savings per month (flood insurance and flood loss reduction) <img id='img' src='static/img/logo/blue_question.png' class="img-q tip" title="Reduction In Flood Losses Per Month is the difference between the expected annual flood loss calculated for adding the freeboard and the expected annual  loss with no freeboard added divided by 12."/>
      </div>

      <!--Time to recover
      <div
        class="pricing-item-price"
        data-price-output='{
          "0": ["", {{time_to_recover_FC_MS0}},"month(s)"],
          "1": ["", {{time_to_recover_FC_MS1}},"month(s)"],
          "2": ["", {{time_to_recover_FC_MS2}},"month(s)"],
          "3": ["", {{time_to_recover_FC_MS3}},"month(s)"],
          "4": ["", {{time_to_recover_FC_MS4}},"month(s)"]
        }'
      >
      <p class="grid-style3 map-style">
      <b class="map-style b-summary-value2"> 
        <span class="pricing-item-price-currency">$</span>
      <span class="pricing-item-price-amount">0</span>
      <span class="pricing-item-price-after"></span> </b> time  to recover the elevation cost <img id='img' src='static/img/logo/blue_question.png' class="img-q tip"  title="Time To Recover The Cost is the Time required to offset the freeboard cost through the monthly savings."/>
      </div>-->

      <!-- Life time benefit
      <div
        class="pricing-item-price"
        data-price-output='{
          "0": ["$", {{netbenefit0}},""],
          "1": ["$", {{netbenefit1}},""],
          "2": ["$", {{netbenefit2}},""],
          "3": ["$", {{netbenefit3}},""],
          "4": ["$", {{netbenefit4}},""]
        }'
      >
      <p class="grid-style3" title="">| Lifetime benefits of the elevation <img id='img' src='static/img/logo/blue_question.png' class="img-q tip"/> : 
        <span class="pricing-item-price-currency"></span>
        <span class="pricing-item-price-amount">0</span>
        <span class="pricing-item-price-after">month(s)</span>
      </div> -->
    </div>
  </div>
</div>
</div> 
</section>
<br>
<br>
<br>

<!--Interactive slide--> 
  <!--Interactive slide--> <section id="section-2"> 
      <div style="overflow-x:auto;">
       
        {% comment %}
               <!-- Need to update
                <form method="get" action="/search" name="Advanced features">
                -->
        
            <!-- Advanced features -->    
                  <button class="btn float-right tip" type="submit" style="margin: 0 75px 20px 0" ></button> 
                  <a class="buttonClass btn-adv tip" onclick='showAF(2);' title="Under development"> Advanced features </a> 
                          <div style="text-align:right">
                             <a class="buttonClass btn-adv tip" onclick='showAF(2);' title="Under development"> Advanced features </a> 
                             <a class="buttonClass btn-adv tip" title="Under development"> Advanced features </a>
                        </div>
                  <div id="table2">
                  <table class="table-slide">
                  <tr class="table-slide-bg">
                    <td><b class="map-style">Home square footage:</b></td>
                    <td>{{SquareFootage}} SF</td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                   <tr>
                    <td><b class="map-style">Number of stories: </b></td>
                    <td>{{No_Floors}}</td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr class="table-slide-bg">
                    <td><b class="map-style">Flood zone: </b></td>
                    <td>{{floodzone}}</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><b class="map-style">Insurance: </b></td>
                    <td><input type="radio" id="Yes_ins" name="insuracnce_option" value="Yes_ins"> <label for="Yes_ins">With insurance</label>
                        <input type="radio" id="No_ins" name="insuracnce_option" value="No_ins" style="margin: 0px 0px 0px 100px;"> <label for="No_ins" >Without insurance</label>
                    </td>
                    <td>Min</td>
                    <td></td>
                    <td>Max</td>
                    <td colspan="3"></td>
                  </tr>
                   <tr class="table-slide-bg">
                    <td><b class="map-style">Expected occupancy timeline: </b></td>
                    <td ><input id="years" type="number" value="30" min="0" max="100" oninput="rangeInput1.value=years.value" />  Years</td>
                    <td>0 Years</td> 
                    <td><input id="rangeInput1" type="range" min="0" max="100" value="30" oninput="years.value=rangeInput1.value" /></td> 
                    <td>100 Years</td>
                  </tr>
                  <tr>
                    <td rowspan="5"><b class="map-style">Flood insurance coverage:</b></td>
                    <td>Building coverage:  $ <input id="bldgCost" type="number" value={{BuildingCoverage}} min="0" max="250000" oninput="rangeInput2.value=bldgCost.value" /></td>
                    <td>$0 </td>
                    <td><input id="rangeInput2" type="range" min="0" max="250000" value={{BuildingCoverage}} oninput="bldgCost.value=rangeInput2.value" /></td>
                    <td>$250,000 </td>
                  </tr>
                  <tr>
                    <td>
                      <label for="DeductibleValue">Building deductible:&nbsp; &nbsp;$ </label>
                        <select name="DeductibleValue" id="DeductibleValue" placeholder={{BuildingDeductibe}}>
                          <option value="V1">1,000</option>
                          <option value="V2">1,250</option>
                          <option value="V3">1,500</option>
                          <option value="V4">2,000 </option>
                          <option value="V5">3,000 </option>
                          <option value="V6">4,000 </option>
                          <option value="V7">5,000 </option>
                          <option value="V8">10,000 </option>
                        </select>
                    </td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>Content coverage:  $ <input id="contCost" type="number" value={{ContentCoverage}} min="0" max="100000" oninput="rangeInput3.value=contCost.value" /></td>
                    <td>$0 </td>
                    <td><input id="rangeInput3" type="range" min="0" max="100000" value={{ContentCoverage}} oninput="contCost.value=rangeInput3.value" /> </td>
                    <td>$100,000 </td>
                  </tr>
                  <tr>
                    <td>
                      <label for="DeductibleValue">Content deductible:&nbsp; &nbsp;$ </label>
                        <select name="DeductibleValue" id="DeductibleValue" placeholder={{ContentDeductible}}>
                          <option value="V1">1,000</option>
                          <option value="V2">1,250</option>
                          <option value="V3">1,500</option>
                          <option value="V4">2,000 </option>
                          <option value="V5">3,000 </option>
                          <option value="V6">4,000 </option>
                          <option value="V7">5,000 </option>
                          <option value="V8">10,000 </option>
                        </select>
                    </td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td>CRS rate is
                        <select name="crsRate" id="crsRate" onchange="myFunction()">
                          <option value="null"> - </option>
                          <option value="45">1</option>
                          <option value="40">2</option>
                          <option value="35">3</option>
                          <option value="30">4 </option>
                          <option value="25">5</option>
                          <option value="20">6</option>
                          <option value="15">7</option>
                          <option value="10">8</option>
                          <option value="5">9</option>
                          <option value="0">10</option>
                        </select>            
                     <span id="crsRate_value" ></span> </td>
                    <td></td>
                    <td></td>
                    <td></td>
                  </tr> 
        
                </table>
                  <p class=" map-style">
               ● The location entered is in a/an {{floodzone}} flood zone, and insurance not/is mandatory.<br>
               ● Maximum limits of $250,000 for building and $100,000 for content with deductible of $1,250. <br>
               ● The property is located in a community that is currently participating in the Community Rating System (CRS) discount. <br>
               ● The CRS rate is 5, with a 25% discount on flood insurance. 
              </p>        
               <!--</form>-->
              </div> </section>{% endcomment %}
<!-- Form for X zone: Ground + 0.5-->
<div id="no">
    <!--Monthly saving-->
    <hr class="style-five">
    <h2 class="map-style-title" >Monthly Savings</h2>
     <div class="graph-description" >
       While the increase in your monthly mortgage payment for adding freeboard will be minor, the monthly savings are substantial, ranging from 
       <b class="map-style">${{summation_total_monthly_saving_low}}</b> to <b class="map-style">${{Optimalsavingsumm}}</b>.
       </div>
       <section id="section-3"><div id="chartNew_XZONE" class="zc-body"></div><div class="bfe"><br>BFE stands for <b>Base Flood Elevation</b></section> 

     <!--Freeboard cost-->
     <hr class="style-five">
     <h2 class="map-style-title">Monthly Freeboard Cost</h2> 
      <div class="graph-description">
        The expense of incorporating freeboard into new structures is surprisingly low. The additional monthly payment amount needed to raise the home at the time it's built ranges from  
        <!--<b class="map-style">${{summation_freeboardCostlow | intcomma}}</b> to <b class="map-style">${{summation_freeboardCosthigh | intcomma}}</b>. -->
        <b class="map-style">${{summation_am_freeboardCostlow | intcomma}}</b> to <b class="map-style">${{summation_am_freeboardCosthigh | intcomma}}</b>.
        <!-- The optimal (maximum) freeboard cost is ${{optimal_freeboardCost |intcomma}} at freeboard height {{optimal_freeboard_freeboardCost}} ft. -->
      </div>  
      <section id="section-4"><div id="chart1" class="zc-body"></div></section>
       
</div>

<!-- Form for other zone: BFE + 1-->
<div id="yes"> 
  <!--Monthly saving-->
      <hr class="style-five">
      <h2 class="map-style-title" >Monthly Savings</h2>
       <div class="graph-description" >
         While the increase in your monthly mortgage payment for adding freeboard will be minor, the monthly savings are substantial, ranging from 
         <b class="map-style">${{summation_total_monthly_saving_low}}</b> to <b class="map-style">${{Optimalsavingsumm}}</b>.
         <!--The optimal (maximum) monthly savings is ${{OptimalSaving | intcomma}} at freeboard height {{OptimalFreeboard}} ft.--> 
         </div>
         {% comment %} <section id="section-3"><div id="chart5" class="zc-body"></div><div class="bfe"><br>BFE stands for <b>Base Flood Elevation</b></section> {% endcomment %}
         <section id="section-3"> <div id="NewChart" class="zc-body"></div> <br>BFE stands for <b>Base Flood Elevation</b></section>
        
 {% comment %}         
 <br>X zone graph (test)
 <div id="Xzone" class="zc-body"></div> 
 {% endcomment %}
     
 
  {% comment %}    <div class="left3 section-tittle-detail mb-40"> 
    <hr class="style-five">
      <h2 class="map-style-title" >Monthly Savings</h2>
       <div class="graph-description" >
         While the increase in your monthly mortgage payment for adding freeboard will be minor, the monthly savings are substantial, ranging from 
         <b class="map-style">${{summation_total_monthly_saving_low}}</b> to <b class="map-style">${{Optimalsavingsumm}}</b>. {% endcomment %}
         <!--The optimal (maximum) monthly savings is ${{OptimalSaving | intcomma}} at freeboard height {{OptimalFreeboard}} ft.--> 
        <!--</div>--> 
         {% comment %} <section id="section-3"><div id="chart5" class="zc-body"></div><div class="bfe"><br>BFE stands for <b>Base Flood Elevation</b></section> {% endcomment %}
         
     <!--</div>-->  
     <!--
         <b class="map-style" style="padding: 0px 63px 0px 0px;">Home square footage:</b>{{SquareFootage}}<br><br>
         <b class="map-style" style="padding: 0px 28px 0px 0px;">Flood insurance coverage:</b> 924,000 - Content  &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<input type="range" id="js_amount_range_2" value="924000" min="0" max="100000"> <input type="number" id="js_amount_input_2" value="924000" min="0" max="100000" style="height:25px"></p>
         <p style="padding: 0px 0px 0px 230px;"  class="map-style">CRS rate is 5, with a 25% discount &nbsp; &nbsp;&nbsp; &nbsp; <input type="range" id="js_amount_range_2" value="25" min="1" max="45"> <input type="number" id="js_amount_input_2" value="25" min="1" max="45" style="height:25px"><br>
         <p style="padding: 0px 0px 0px 230px;"  class="map-style">CRS community rating</p> 
         <b class="map-style" style="padding: 0px 89px 0px 0px;">Number of stories:</b> {{No_Floors}}<br><br>
         <b class="map-style" style="padding: 0px 143px 0px 0px;">Flood zone:</b> {{floodzone}}<br><br>
         <b class="map-style">Expected occupancy timeline:</b>&nbsp;&nbsp;30 years   &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;  &nbsp;&nbsp; &nbsp;&nbsp;  &nbsp;&nbsp; &nbsp;&nbsp;  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<input type="range" id="js_amount_range_1" value="30" min="0" max="100" > <input type="number" id="js_amount_input_1" value="15" min="0" max="100" style="height:25px"><br><br>
         <p style="padding: 0px 0px 0px 230px;" class="map-style">231,000 - Building &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;  &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <input type="range" id="js_amount_range_2" value="231000" min="0" max="250000"> <input type="number" id="js_amount_input_2" value="231000" min="0" max="250000" style="height:25px"></p>
         -->
         
 
   <!--Freeboard cost-->
     <hr class="style-five">
      <h2 class="map-style-title">Monthly Freeboard Cost</h2> 
       <div class="graph-description">
         The expense of incorporating freeboard into new structures is surprisingly low. The additional monthly payment amount needed to raise the home at the time it's built ranges from  
         <!--<b class="map-style">${{summation_freeboardCostlow | intcomma}}</b> to <b class="map-style">${{summation_freeboardCosthigh | intcomma}}</b>. -->
         <b class="map-style">${{summation_am_freeboardCostlow | intcomma}}</b> to <b class="map-style">${{summation_am_freeboardCosthigh | intcomma}}</b>.
         <!-- The optimal (maximum) freeboard cost is ${{optimal_freeboardCost |intcomma}} at freeboard height {{optimal_freeboard_freeboardCost}} ft. -->
       </div>  
       <section id="section-4"><div id="chart1" class="zc-body"></div></section>
 
 
 <!--Insurance-->
    <hr class="style-five">
     <h2 class="map-style-title">Monthly Insurance Premium Savings</h2>
      <div class="graph-description" >
       Building your home higher results in monthly insurance premium savings of <b class="map-style">${{summation_total_monthly_premium_savingLow | intcomma}}</b> to <b class="map-style">${{summation_total_monthly_premium_savingHigh | intcomma}}</b>. 
        <!--, also increases or stabilizes flood premiums savings per month ${{monthly_premium_saving0 | intcomma}} to ${{monthly_premium_saving4 | intcomma}}.--> 
        <!--The optimal (minimum) annual insurance premium is ${{optimal_total_annual_premium | intcomma}} at freeboard height {{optimal_total_annual_premium_freeboard}} ft.-->
       </div>
      <section id="section-5">  
       <center>
        <div id="chart2" class="zc-body"></div>
       </center> </section>
 
 
 <!--Reduction in expected flood losses-->
   <hr class="style-five">
      <h2 class="map-style-title">Monthly Savings from Flood Loss Reduction</h2>      
         <div class="graph-description" >
           Damaging floods do not occur every month. However, considering the chance of floods happening we can calculate the average annual or monthly flood loss.
           Adding freeboard results in monthly savings from flood loss reduction of  <b class="map-style">${{summation_monthly_avoided_lossLow | intcomma}}</b> to <b class="map-style">${{summation_monthly_avoided_lossHigh | intcomma}}</b>. 
           <!--The optimal (minimum) expected flood loss is ${{optimal_AAL_absCurrency | intcomma}} at freeboard height {{optimal_AAL_absCurrency_freeboard}} ft.-->
         </div>
       <section id="section-6"><div id="chart3" class="zc-body"></div> </section> 
       </section>
   </div> 
 </div>
</div>


  <!--Recover-->
{% comment %} <div class="left3 section-tittle-detail mb-40"> 
  <hr class="style-five">
     <h2 class="map-style-title">Time to Recover the Freeboard Cost</h2>
      <div class="graph-description" >
        The time required to recover the cost of freeboard is surprisingly low for new construction when considering reductions in flood insurance premiums and the expected reductions in flood loss. 
        Considering <b class="map-style">ONLY</b> flood insurance premium savings, the time to recover the additional cost of construction ranges between <b class="map-style">{{summation_time_to_recover_FC_PSlow}}</b> month(s) and <b class="map-style">{{summation_time_to_recover_FC_PShigh}} month(s)</b>. 
        Considering both savings in flood insurance premiums and expected reductions in flood loss, this is decreased to between <b class="map-style">{{summation_time_to_recover_FC_TBlow}}</b> month(s) and <b class="map-style">{{summation_time_to_recover_FC_TBhigh}} month(s)</b>.       
      </div>
      <div id="chart4" class="zc-body"></div>
  </div> {% endcomment %}

<!--Overall-->
 {% comment %}  <div class="left3 section-tittle-detail"> 
   <hr class="style-five"> 
     <h2 class="map-style-title">Overall Graph</h2>
       <div class="graph-description" >
        This overall graph includes all analysis information integrated in one chart that provides intuitive decision making information with all estimates converted to monthly basis.       
      </div>
       <Section id="section-7" >   <div id="myChart" class="zc-body-overall"></div>  </section>
  </div> {% endcomment %}
</main>

<!--Result details End-->



<!--zingchart script-->
  <script>
   /*zingchart*/
  // DEFINE CHART LOCATIONS (IDS)
  // -----------------------------
  // Main chart render location
  // var chartId = 'myChart';
  var chart1Id = 'chart1'; //Freeboard Cost
  var chart2Id = 'chart2'; //Annual Insurance Premiums
  var chart3Id = 'chart3'; //Expected Annual Flood Loss
  var chart4Id = 'chart4'; //Time to Recover the Freeboard Cost
  var chart5Id = 'chart5'; //Monthly Savings
  var chart6Id = 'chart6'; //Overall graph

  // CHART CONFIG
  // -----------------------------
  // Chart 1
  var chart1Data = {
    type: 'bar',
    borderWidth: '1px',
    borderColor: '#dae5ec',
    title: {
      fontWeight: 'normal',
      fontColor: 'var(--black)',
      align: 'left',
      marginLeft: '2rem'
    },
    cursor: 'hand',
    globals: {
      fontColor: 'var(--fontColor)',
      fontfamily: 'Raleway'
    },
    legend: {
      borderWidth: 0,
      layout: '1',
      marker: {
        type: 'pie'
      }
    },
    scaleX: { 
      markers: [],
      labels: [ 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      // labels: [ 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      //labels: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      tick: {
        visible: false
      },
    crosshairX: {},
    },
    scaleY: {
    format: "$%v",
    negation: "currency",
    thousandsSeparator: ", ",
    multiplier: true
    },
    plot: {
    tooltip:{ 
      fontColor: 'var(--white)',
      text: '$%v',
      thousandsSeparator: ", ",
      backgroundColor:'var(--red)'
      },
    animation : {
      effect : 1,
      sequence : 2,
      speed : 100
    },
  },
    series: [
      {
        text: 'Monthly freeboard cost',
        backgroundColor: 'var(--red)',
        alpha: 0.95,
        borderRadiusTopLeft: '7px',
        //values: {{freeboardCost_json}}   
        values: {{Amortized_FC_json}}  
      }
    ]
  };

  // Chart 2
   var chart2Data = {
    type: 'bar',
    borderWidth: '1px',
    borderColor: '#dae5ec',
    title: {
      fontWeight: 'normal',
      fontColor: 'var(--black)',
      align: 'left',
      marginLeft: '2rem'
    },
    cursor: 'hand',
    globals: {
      fontColor: 'var(--fontColor)',
      fontfamily: 'Raleway'
    },
    legend: {
      borderWidth: 0,
      layout: '1',
      marker: {
        type: 'pie'
      }
    },
    scaleX: { 
      markers: [],
      labels: ['BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
   //   labels: ['BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
   // labels: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      tick: {
        visible: false
      },
    crosshairX: {},
    },
    scaleY: {
    format: "$%v",
    negation: "currency",
    thousandsSeparator: ", ",
    multiplier: true
    },
    plot: {
    tooltip:{ 
      fontColor: 'var(--white)',
      text: '$%v',
      thousandsSeparator: ", ",
      backgroundColor:'var(--blue)'
      },
    animation : {
      effect : 1,
      sequence : 2,
      speed : 100
    },
  },
    series: [
      {
        text: 'Monthly insurance premium savings',
        backgroundColor: 'var(--blue)',
        alpha: 0.95,
        borderRadiusTopLeft: '7px',
        values: {{monthly_premium_saving_json}}   
      }
    ]
  }; 
 

 // Chart 3: Monthly Savings from Flood Loss Reduction
  let chart3Data = {
  type: 'bar',
  borderWidth: '1px',
  borderColor: '#dae5ec',
  legend: {
    alpha: 0.05,
    borderWidth: '0px',
    layout: 'x2',
    marker: {
      type: 'circle',
      borderColor: 'none',
      size: '10px'
    },
  },
  plot: {
    animation: {
      effect: 'ANIMATION_SLIDE_BOTTOM'
    }
  },
  scaleX: {
    guide: {
      visible: false
    },
    item: {
      fontColor: '#7e7e7e'
    },
    labels: [ 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
   // labels: ['BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
    // labels: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
    lineColor: '#7E7E7E'
  },
  scaleY: {
      
    format: "$%v",
    negation: "currency",
    thousandsSeparator: ", ",
    multiplier: true,
      guide: {
        lineStyle: 'solid'
      },
      minorTick: {
        placement: 'cross',
        size: '6px'
      },
      minorTicks: 1
    },
  tooltip: {
    text: '$%v',
    thousandsSeparator: ", ",
  },
  series: [
    {
      text: 'Monthly savings from flood loss reduction — without insurance',
      values: [ 0, 0, 0, 0],
      //values: [ 0, 0, 0, 0, 0],
      //values: [185537, 144022, 97204, 31222, 0, 0, 0, 0, 0],
      alpha: 0.95,
      borderRadiusTopLeft: '7px',
      backgroundColor: '#eb9d17',
    },
    {
      text: 'Monthly savings from flood loss reduction — with insurance',
      values: {{monthly_avoided_loss_json}},
      borderRadiusTopLeft: '7px',
      alpha: 0.95,
      backgroundColor: '#f7e0b7',
    }
  ]
};

   // Chart 4
var chart4Data = {
  type: 'line',
  borderWidth: '1px',
  borderColor: '#dae5ec',
  title: {
    fontWeight: 'normal',
    fontColor: 'var(--black)',
    align: 'left',
    marginLeft: '2rem'
  },
  plot: {
    tooltip: {
      visible: false
    },
    cursor: 'hand'
  },

  legend: {
    borderWidth: 0,
    layout: '1',
     width: '90%',
     x: '3%',
    marker: {
      type: 'pie'
    }
  },
  scaleX: {
    markers: [],
    labels: [ 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
    // labels: [ 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
    // labels: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
  },
  crosshairX: {},
  scaleY: {
    label: {
      text: "Month(s)",
      fontWeight: 'normal'
    },
  },
  series: [
    {
      text: 'The reduction in insurance premiums ',
      values: {{time_to_recover_FC_PS_json}},
      lineColor: 'var(--orange)',
      marker : {
      type : 'circle',
      borderWidth : 1,
      borderColor : 'var(--orange)',
      size : 5,
      backgroundColor : 'var(--orange)'
      },
      hoverMarker : {
        type : 'circle',
        size : 6,
        backgroundColor : '#FFF',
        borderWidth : 1,
        borderColor : 'var(--orange)'
      },
    },
    {
      text: 'The reduction in insurance premiums and the reduction of flood losses',
      values: {{time_to_recover_FC_TB_json}},
      lineColor: '#c4c722',
      marker : {
      type : 'circle',
      borderWidth : 1,
      borderColor : '#c4c722',
      size : 5,
      backgroundColor : '#c4c722'
      },
      hoverMarker : {
        type : 'circle',
        size : 6,
        backgroundColor : '#FFF',
        borderWidth : 1,
        borderColor : '#c4c722'
      },
    }    
  ]
};

/*
* define Marker class to construct
* markers on the fly easier.
*/
function Marker(_index) {
  return {
    type: 'line',
    flat: false,
    lineColor: '#424242',
    lineWidth: '1px',
    range: [_index]
  }
}

/*
* define Label class to construct
* labels on the fly easier.
*/
function Label(_text, _id, _offsetX, _offsetY) {
  return {
    id: _id,
    text: _text,
    angle: 0,
    padding: '5px 10px 5px 10px',
    backgroundColor: '#eeeeee',
    cursor: 'pointer',
    flat: false,
    fontSize: '13px',
    fontStyle: 'bold',
    offsetX: _offsetX,
    offsetY: _offsetY ? _offsetY : 0,
    textAlign: 'right',
    wrapText: true
  }
}

// format the label text
let formatLabelText = (_nodeindex, _scaleText) => {
  let plotInfo = null;
  let nodeInfo;
  let seriesText = '';
  let labelString = isNaN(_scaleText) ? _scaleText + '<br>' : '';
  let color = '';
  let plotLength = zingchart.exec('chart4Data', 'getplotlength', {
    graphid: 0
  });

  for (let i = 0; i < plotLength; i++) {
    plotInfo = zingchart.exec('chart4Data', 'getobjectinfo', {
      object: 'plot',
      plotindex: i
    });
    nodeInfo = zingchart.exec('chart4Data', 'getobjectinfo', {
      object: 'node',
      plotindex: i,
      nodeindex: _nodeindex
    });
    color = plotInfo.lineColor ? plotInfo.lineColor : plotInfo.backgroundColor1;
    seriesText = plotInfo.text ? plotInfo.text : ('Series ' + (i + 1));
    labelString += '<span style="color:' + color + '">' + seriesText + ':</span>' +
      ' ' + nodeInfo.value + '<br>';
  }

  return labelString;
};

// global array for markers since you can only update the whole array
let markersArray = [];
let labelsArray = [];

// hash table for markers
let markerHashTable = {};

/*
* Register a graph click event and then render a chart with the markers
*/
zingchart.bind('chart4Data', 'click', (e) => {
  let xyInformation;
  let nodeIndex;
  let scaleText;

  // make sure not a node click and click happend in plotarea
  if (e.target != 'node' && e.plotarea) {
    xyInformation = zingchart.exec('chart4Data', 'getxyinfo', {
      x: e.ev.clientX,
      y: e.ev.clientY
    });

    // if anything is found, 0 corresponds to scale-x
    if (xyInformation && xyInformation[0] && xyInformation[2]) {
      nodeIndex = xyInformation[0].scalepos;
      scaleText = xyInformation[0].scaletext;

      // check hash table. Add marker
      if (!markerHashTable['nodeindex' + nodeIndex]) {
        let nodeInfo = zingchart.exec('chart4Data', 'getobjectinfo', {
          object: 'node',
          nodeindex: nodeIndex,
          plotindex: 0
        });

        let labelText = formatLabelText(nodeIndex, scaleText);
        let labelId = 'label_' + nodeIndex;
        // create a marker
        let newMarker = new Marker(nodeIndex);
        let newLabel = new Label(labelText, labelId, nodeInfo.x, nodeInfo.y);

        markerHashTable['nodeindex' + nodeIndex] = true;
        markersArray.push(newMarker);

        labelsArray.push(newLabel);

        // render the marker
        chart4Data.scaleX.markers = markersArray;
        chart4Data.labels = labelsArray;
        zingchart.exec('chart4Data', 'setdata', {
          data: chart4Data
        });
      } else {
        console.log('---marker already exists----');
      }
    }
  }
});

/*
* Register a node_click event and then render a chart with the markers
*/
zingchart.bind('chart4Data', 'node_click', (e) => {
  // check hash table. Add marker
  if (!markerHashTable['nodeindex' + e.nodeindex]) {
    let labelText = formatLabelText(e.nodeindex, e.scaletext);
    let labelId = 'label_' + e.nodeindex;
    // create a marker
    let newMarker = new Marker(e.nodeindex, labelText, e.plotindex);
    let newLabel = new Label(labelText, labelId, e.ev.layerX, e.ev.layerY);

    markerHashTable['nodeindex' + e.nodeindex] = true;
    markersArray.push(newMarker);

    labelsArray.push(newLabel);

    // render the marker
    chart4Data.scaleX.markers = markersArray;
    chart4Data.labels = labelsArray;
    zingchart.exec('chart4Data', 'setdata', {
      data: chart4Data
    });
  } else {
    console.log('---marker already exists----');
  }
});

let labelMouseDown = false;
let labelId = null;

/*
* bind mousedown event for dragging label
*/
zingchart.bind('chart4Data', 'label_mousedown', (e) => {
  labelMouseDown = true;
  labelId = e.labelid;
  zingchart.exec('chart4Data', 'hideguide');
});

zingchart.bind('chart4Data', 'mousemove', (e) => {
  if (labelMouseDown && labelId) {
    zingchart.exec('chart4Data', 'updateobject', {
      type: 'label',
      data: {
        id: labelId,
        offsetY: e.ev.layerY
      }
    });
  }
});

zingchart.bind('chart4Data', 'mouseup', () => {
  labelMouseDown = false;
  labelId = null;
  zingchart.exec('chart4Data', 'showguide');
});

zingchart.bind('chart4Data', 'doubleclick', (e) => {
  console.log(e);
});

  // Chart 5: Monthly savings
    let chart5Data = {
    type: 'bar',    
    borderWidth: '1px',
    borderColor: '#dae5ec',
    legend: {
      alpha: 0.05,
      borderWidth: '0px',
      layout: 'x2',
      marker: {
        type: 'circle',
        borderColor: 'none',
        size: '10px'
      },
    },
    plot: {
      animation: {
        effect: 'ANIMATION_SLIDE_BOTTOM'
      }
    },
    scaleX: {
      guide: {
        visible: false
      },
      item: {
        fontColor: '#7e7e7e'
      },
      labels: [ 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      //labels: ['BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      //labels: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      lineColor: '#7E7E7E'
    },
    scaleY: {
        
      format: "$%v",
      negation: "currency",      
      thousandsSeparator: ", ",
      multiplier: true,
        guide: {
          lineStyle: 'solid'
        },
        minorTick: {
          placement: 'cross',
          size: '6px'
        },
        minorTicks: 1
      },
    tooltip: {
      text: '$%v',
      thousandsSeparator: ", ",
    },
    series: [
      {
        text: 'Monthly savings with insurance',
        values: {{total_monthly_saving_json}},
        alpha: 0.95,
        borderRadiusTopLeft: '7px',
        backgroundColor: '#189447',
      },
      {
        text: 'Monthly savings without insurance',
        values: [ 17088, 17074, 17041, 17006],
       // values: [ 16733, 17088, 17074, 17041, 17006],
        //values: [988, 4412, 8280, 13743, 16733, 17088, 17074, 17041, 17006],
        borderRadiusTopLeft: '7px',
        alpha: 0.95,
        backgroundColor: '#add9be'
      }
    ]
  };

  zingchart.render({
    id: 'chart5Id',
    data: chart5Data,
    height: '100%', 
    width: '100%',
  });


  // Chart 6
  // DEFINE DATA
  // -----------------------------
 let chartData = [
    {
      type: 'line',       
      borderWidth: '1px',
      borderColor: '#dae5ec',
      text: 'Monthly savings with insurance',
      values: {{ total_monthly_saving_json}},
      scales: 'scale-x,scale-y',
      lineColor: '#189447',
      legendMarker: {
        type: 'circle'
      },
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      },
      marker: {
        backgroundColor: '#189447'
      }
    },    {
      type: 'line', 
      text: 'Monthly savings without insurance',
      values: [17088, 17074, 17041, 17006],
      //values: [16733, 17088, 17074, 17041, 17006],
      //values: [988, 4412, 8280, 13743, 16733, 17088, 17074, 17041, 17006],
      scales: 'scale-x,scale-y',
      lineColor: '#add9be',
      legendMarker: {
        type: 'circle'
      },
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      },
      marker: {
        backgroundColor: '#add9be'
      }
    },
    {
      type: 'bar',
      text: 'Amortized cost',
      values: {{Amortized_FC_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#ff614f',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    },
    {
      type: 'bar',
      text: 'Insurance savings per month',
      values: {{monthly_premium_saving_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#07d9a4',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    },
    {
      type: 'bar', 
      text: 'Reduction in expected flood loss per month',
      values: {{monthly_avoided_loss_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#2480bf',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    }

  ];

let chartConfig = {
    type: 'mixed',   
    borderWidth: '1px',
    borderColor: '#dae5ec',
    legend:{
     layout: '1x5' ,
     width: '95%',
     margin: '20px 10px 10px 10px',
     borderColor: 'whtie'
    },
    scaleX: {
      values: ['BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      //values: [ 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      //values: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      guide: {
        lineColor: '#BDBDBD',
        lineStyle: 'solid'
      },
      label: {
        text: 'BFE + Freeboard (ft)'
      },
    },
    scaleY: {  
    format: "$%v",
    negation: "currency",
    thousandsSeparator: ", ",
    multiplier: true,
      guide: {
        lineStyle: 'solid'
      },
      minorTick: {
        placement: 'cross',
        size: '6px'
      },
      minorTicks: 1
    },
    {% comment %} 
    scaleY2: {
    format: '%v',    
    negation: "currency",
    guide: {
      visible: false
    },
    label: {
      text: 'Y-2 label'
    },
    zooming: true
  }, 
  {% endcomment %}
    crosshairX: {
      plotLabel: {
        visible: false
      }
    },
    series: chartData
  };



 // Chart 7: new
  // DEFINE DATA
  // -----------------------------
  // Chart 7: new
  // DEFINE DATA
  // -----------------------------
  let chartNew = [
    {
      type: 'bar',    
      text: 'Freeboard cost',
      values: {{Amortized_FC_neg_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#CD5B77',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    }, 
    {
      type: 'bar', 
      text: 'Insurance savings',
      values: {{monthly_premium_saving_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#953F8A',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    },
    {
      type: 'bar',
      text: 'Flood loss reduction',
      values: {{monthly_avoided_loss_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#4959D9',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    },
    {
      type: 'bar',
      text: 'Total monthly savings',
      values: {{total_monthly_saving_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#65A8EA',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    }

  ];

let chartConfig2 = {
    type: 'mixed',   
    borderWidth: '1px',
    borderColor: '#dae5ec',
    legend:{
     layout: '1x4' ,
     borderColor: 'whtie'
    },
    scaleX: {
      values: [ 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
     // values: [ 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      //values: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      guide: {
        lineColor: '#BDBDBD',
        lineStyle: 'solid'
      },
      label: {
        text: 'BFE + Freeboard (ft)'
      },
    },
    scaleY: {  
    format: "$%v",
    negation: "currency",
    thousandsSeparator: ", ",
    multiplier: true,
      guide: {
        lineStyle: 'solid'
      },
      minorTick: {
        placement: 'cross',
        size: '6px'
      },
      minorTicks: 1
    },
    {% comment %} 
    scaleY2: {
    format: '%v',    
    negation: "currency",
    guide: {
      visible: false
    },
    label: {
      text: 'Y-2 label'
    },
    zooming: true
  }, 
  {% endcomment %}
    crosshairX: {
      plotLabel: {
        visible: false
      }
    },
    series: chartNew
  };




//////////CHARTS FOR X ZONE  
// Chart 8: X ZONE
// MONTHLY SAVINGS
  let chartNew_XZONE = [
    {
      type: 'bar',    
      text: 'Freeboard cost',
      values: {{Amortized_FC_neg_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#CD5B77',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    }, 
    {
      type: 'bar', 
      text: 'Insurance savings',
      values: {{monthly_premium_saving_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#953F8A',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    },
    {
      type: 'bar',
      text: 'Flood loss reduction',
      values: {{monthly_avoided_loss_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#4959D9',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    },
    {
      type: 'bar',
      text: 'Total monthly savings',
      values: {{total_monthly_saving_json}},
      scales: 'scale-x,scale-y',
      backgroundColor: '#65A8EA',
      borderRadiusTopLeft: '7px',
      alpha: 0.90,
      tooltip: {
        text: '$%v',
        negation: "currency",
        thousandsSeparator: ", ",
        wrapText: true
      }
    }

  ];

let chartConfigXZONE = {
    type: 'mixed',   
    borderWidth: '1px',
    borderColor: '#dae5ec',
    legend:{
     layout: '1x4' ,
     borderColor: 'whtie'
    },
    scaleX: {
      values: [ 'Ground +0.5 ft', 'Ground +1.5 ft', 'Ground +2.5 ft', 'Ground +3.5 ft'],
     // values: [ 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      //values: ['BFE -4 ft', 'BFE -3 ft', 'BFE -2 ft', 'BFE -1 ft', 'BFE +0 ft', 'BFE +1 ft', 'BFE +2 ft', 'BFE +3 ft', 'BFE +4 ft'],
      guide: {
        lineColor: '#BDBDBD',
        lineStyle: 'solid'
      },
      label: {
        text: 'Ground + Freeboard (ft)'
      },
    },
    scaleY: {  
    format: "$%v",
    negation: "currency",
    thousandsSeparator: ", ",
    multiplier: true,
      guide: {
        lineStyle: 'solid'
      },
      minorTick: {
        placement: 'cross',
        size: '6px'
      },
      minorTicks: 1
    },
    crosshairX: {
      plotLabel: {
        visible: false
      }
    },
    series: chartNew_XZONE
  };


  // RENDER CHARTS
  // -----------------------------

  // Chart 1
  zingchart.render({ 
    id: chart1Id, 
    data : chart1Data, 
    width: '100%'
  });

  // Chart 2
  zingchart.render({ 
    id: chart2Id, 
    data : chart2Data, 
    width: '100%'
  });

  // Chart 3
  zingchart.render({ 
    id: chart3Id, 
    data : chart3Data, 
    width: '100%'
  });

  // Chart 4
  zingchart.render({ 
    id: chart4Id, 
    data : chart4Data, 
    width: '100%'
  });

  // Chart 5
  zingchart.render({ 
    id: chart5Id, 
    data : chart5Data, 
    width: '100%'
  });

  // Chart 6
  zingchart.render({
    id: 'myChart',
    data: chartConfig,
    width: '100%'
  });

  // Chart 7 (New)
  zingchart.render({
    id: 'NewChart',
    data: chartConfig2,
    width: '100%'
  });


    //XZONE CHARTS 
    // Chart 8
    zingchart.render({
      id: 'chartNew_XZONE',
      data: chartConfigXZONE,
      width: '100%'
    });
{% comment %}       // Chart 8 (New)
  zingchart.render({
    id: 'Xzone',
    data: chartConfig3,
    width: '100%'
  }); {% endcomment %}
  
  var ctx = document.getElementById('chart');

  var chart = (ctx, {
            type: 'line',
            data: {
                labels: ['+0ft freeboard','+`0`ft freeboard'],
                datasets: [{
                    label: 'My First dataset',
                    backgroundColor: '#33b5e5',
                    borderColor: '#33b5e5',
                    data: [15,10]   
                }]
            },
            options: {
              responsive:true,
              legend:{
                display:false,
              },
              title: {
                display:false,
                text:'Text',
              },
              
              scales: {
                xAxes: [{
                  display: true
                }],
                yAxes: [{
                  display: true,
                  scaleLabel: {
                    display: true,
                    labelString: 'dollar',
                  },
                  ticks: {
                    min: 0,
                    stepSize: 10
                  }
                }]
              }
            }
    }); 


    </script>
    

    <!-- Scroll Up -->
    <div id="back-top" >
        <a title="Go to Top" href="#"> <i class="fas fa-level-up-alt"></i></a>
    </div>
      <script src = "https://code.highcharts.com/highcharts.js"></script>
    <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-2.2.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-widgets-2.2.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-tables-2.2.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.pydata.org/bokeh/release/bokeh-api-2.2.1.min.js"></script> 
    <!-- {{script_insurance | safe}}-->
    <script src="../static/js/disclaimer.js"></script>
    <!-- Jquery-->
    <script src="./static/js/vendor/jquery-1.12.4.min.js"></script>

    
    <!-- Jquery Mobile Menu -->

    <!--save as pdf js
    <script src="./static/js/jquery.slicknav.min.js"></script>
    <script type = "text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script type = "text/javascript" src = "https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script type = "text/javascript" src = "http://code.jquery.com/jquery-latest.min.js"></script>
-->

<!-- Accessibility Code for "floodsafehome.lsu.edu" -->
<script> 
    window.interdeal = { 
        "sitekey": "e8d3d174e189523ecbfdacfddd4c53b8", 
        "Position": "Left", 
        "Menulang": "EN", 
        "domains": { "js": "https://cdn.equalweb.com/", 
        "acc": "https://access.equalweb.com/" }, 
        "btnStyle": { "vPosition": [ "80%", null ], 
        "scale": [ "0.5", "0.5" ], 
        "icon": { "type": 7, 
        "shape": "semicircle", "outline": false }, 
        "color": { "main": "#1876c9", "second": "" } 
        } }; 
        
    (function(doc, head, body) { 
        var coreCall = doc.createElement('script'); 
        coreCall.src = 'https://cdn.equalweb.com/core/2.1.10/accessibility.js'; 
        coreCall.defer = true; 
        coreCall.integrity = 'sha512-PWvjZ/e9EGeHEPppEOqscViKxQIW1/5rJeFedXLJiv0IrltJPvuhrYOiUsOkQ49FaZ5HSDp51/O/6V9uL2nNIA=='; 
        coreCall.crossOrigin = 'anonymous'; coreCall.setAttribute('data-cfasync', true ); 
        body? body.appendChild(coreCall) : head.appendChild(coreCall); })
    (document, document.head, document.body); 
</script>
<!-- Accessibility Code for "floodsafehome.lsu.edu" end-->

<!--Add multiple address-->
{% comment %}<script>
 document.getElementById("add").onclick  = function() {

  var node = document.createElement("Li");
  var text = document.getElementById("user_input").value; 
  var textnode=document.createTextNode(text);
  node.appendChild(textnode);
  document.getElementById("list_item").appendChild(node);
  addr_list_str = document.getElementById("addr_list").value
    if(addr_list_str.length == 0) {
      document.getElementById("addr_list").value = text
    } else {
      document.getElementById("addr_list").value = document.getElementById("addr_list").value + "$$" + text
    }
} 
</script>{% endcomment %}

<!--Add multiple address end-->

<script>
  function myFunction(){
    event.preventDefault();
  } 
</script>

<!--Script for different forms based on zone types-->
<script type="text/javascript">
  $(document).ready(function(){
    var otherzonelist = {{otherzonelist|safe}};
    var otherzoneAddress = otherzonelist[0];

    var xzonelist = {{xzonelist|safe}};
    var xzoneAddress = xzonelist[0];
    
    $("#buttontest").click(function(){
      // Other zone excecpt x zone
    if ($('#tags').val() == otherzoneAddress) {   
       $("#yes").show(); 
    }
      //x zone 
    else if ($('#tags').val() == xzoneAddress) {   
       $("#no").show(); 
    } 
    else {
       $("#yes").hide();    
       $("#no").hide();
       $("#incorrect").show();
    }
    });

    $(document).on('submit', '#my-form', function() {
      // do your things
      return false;
     });
 
    console.log("Other zone:", otherzoneAddress, ", X zone:", xzoneAddress);
    });
</script>


<script>
// Creating a function to add item from list
function addItem() {
        var a = document.getElementById("list");
        var candidate = document.getElementById("user-input-co");
        var li = document.createElement("li");
        li.setAttribute('id', candidate.value);
        li.appendChild(document.createTextNode(candidate.value));
        a.appendChild(li);
        
        addr_list_str = document.getElementById("addr_list").value
        if(addr_list_str.length == 0) {
          document.getElementById("addr_list").value =  a.textContent
        } else {
          //document.getElementById("addr_list").value = document.getElementById("addr_list").value + "$$" + a.textContent
          document.getElementById("addr_list").value =  a.textContent
        }
    }

// Creating a function to remove item from list
function removeItem() {

    // Declaring a varible to get select element
    var a = document.getElementById("list");
    var candidate = document.getElementById("user-input-co");
    var item = document.getElementById(candidate.value);
    a.removeChild(item);}
</script> 


<!--CRS rate selection-->
<script>
function myFunction() {
  var x = document.getElementById("crsRate").value;
  document.getElementById("crsRate_value").innerHTML = ", with a " + x + "% discount";
  }
</script>
<!--CRS rate selection end-->

<!--Advanced features -->
<script>
function showAF(nr) {
    document.getElementById("table2").style.display="none";
    document.getElementById("table"+nr).style.display="block";
}
</script>
<!--Advanced features end-->

<!--Advanced parameters -->
<script>
function show(nr) {
    document.getElementById("table1").style.display="none";
    document.getElementById("table"+nr).style.display="block";
}
</script>
<!--Advanced parameters end-->

<!--Banner: under construction-->
    <script>
    document.querySelector(".banner__close").addEventListener("click", function () {
        this.closest(".banner").style.display = "none";
    });
    </script>

<!--Open PDF separate window-->
<script>
function openInNewTab(obj)
{
    //alert(obj.value);
    var win = window.open(obj.value, '_blank');
    win.focus();
}
</script>
</body>
</html>



